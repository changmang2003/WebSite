window.onload = function (e) {
    liff.init(function (data) {
        initializeApp(data);
    });
};

function initializeApp(data) {
    //取得QueryString
      let urlParams = new URLSearchParams(window.location.search);
    //顯示QueryString
      $('#QueryString').val(urlParams.toString());
    //顯示UserId        
      $('#userid').val(data.context.userId);
        
    // Get Profile
    document.getElementById('ButtonGetProfile').addEventListener('click', function () {
    //取得User Proile
            liff.getProfile().then(
                profile=> {
                    //顯示在text box中
                    $('#UserInfo').val(profile.displayName);
                    //居然可以alert
                    window.alert('done');
                }
            );
    });
    

    // sendMessages call
    document.getElementById('ButtonSendMsg').addEventListener('click', function () {
        liff.sendMessages([
                 {
                     type: 'text',
                     text: $('#msg').val()
                 }
                ])
               .then(() => {
                   alert('done');
               })
               
    });

}